{"version":3,"file":"modal-alert.esm.min.js","sources":["../src/js/defaults.js","../src/modal-alert.js"],"sourcesContent":["export const defaults = {\n\n  // settings to be applied to all dialog types\n  // can be reassigned on single types\n  globals: {\n    onOpen: null,\n    onClose: null,\n    cssFile: null,    // css file to be automatically loaded\n    animation: true,\n    showMarks: true,\n    callback: null,\n    timer: null,\n    mes: null,\n    heading_class: null,\n    text_class: null,\n\n    // extra btn markup, ignored on confirm\n    extra_btn: null,\n    extra_btn_selector: null,\n    extra_btn_focus: true\n  },\n\n  success: {\n    title: 'Operazione completata',\n    ok_btn_text: 'OK',\n    ok_btn_class: 'btn btn-success',\n    timer: 4000 // ms\n  },\n  error: {\n    title: 'Si è verificato un errore',\n    ok_btn_text: 'OK',\n    ok_btn_class: 'btn btn-error'\n  },\n  warning: {\n    title: 'Attenzione!',\n    ok_btn_text: 'OK',\n    ok_btn_class: 'btn btn-warning'\n  },\n  info: {\n    title: null,\n    ok_btn_text: 'OK',\n    ok_btn_class: 'btn btn-info'\n  },\n  confirm: {\n    title: 'Confermi?',\n    ok_btn_text: 'OK',\n    cancel_btn_text: 'Annulla',\n    cancel_focus: true, // false to give focus to the ok button\n    ok_btn_class: 'btn btn-outline-confirm',\n    cancel_btn_class: 'btn btn-confirm'\n  }\n\n};\n","import confirm_mark from './svg/confirm.svg';\nimport info_mark from './svg/info.svg';\nimport error_mark from './svg/error.svg';\nimport success_mark from './svg/success.svg';\nimport warning_mark from './svg/warning.svg';\n\nimport {defaults} from './js/defaults';\n\n// https://developer.mozilla.org/en-US/docs/Web/API/HTMLDialogElement\n\n// TODO check per tutti gli elelenti di extra_btn\n// TODO eliminare dist (come incorporare svg?)\n\nexport default function (params, custom_defaults = {}) {\n\n  const marks = {\n    confirm: confirm_mark,\n    info: info_mark,\n    error: error_mark,\n    success: success_mark,\n    warning: warning_mark\n  };\n\n  try {\n\n    // garbage collection\n    let dialog = document.querySelector('.modal-alert');\n    if(dialog) {\n      dialog.remove();\n    }\n\n\n    params = {\n      ...(defaults.globals?? {}),\n      ...(custom_defaults.globals?? {}),\n      ...(defaults[params.type]?? {}),\n      ...(custom_defaults[params.type]?? {}),\n      ...params\n    };\n\n    if(!params.type || Object.keys(defaults).filter(item => item !== 'global').indexOf(params.type) === -1) {\n      throw 'Missing or incorrect `type` parameter';\n    }\n\n    if(params.callback && typeof params.callback !== 'function') {\n      throw 'Incorrect `callback` parameter';\n    }\n    if(params.onOpen && typeof params.onOpen !== 'function') {\n      throw 'Incorrect `onOpen` parameter';\n    }\n    if(params.onClose && typeof params.onClose !== 'function') {\n      throw 'Incorrect `onClose` parameter';\n    }\n\n    if(params.cssFile && !document.querySelector(`link[href='${params.cssFile}']`)) {\n      document.head.insertAdjacentHTML('beforeend',\n        `<link rel=\"stylesheet\" href=\"${params.cssFile}\" type=\"text/css\">`\n      );\n    }\n\n\n    // if(!params.title) {\n    //   throw '`title` parameter not present';\n    // }\n\n    document.body.insertAdjacentHTML('beforeend',\n      `<dialog class=\"modal-alert modal-alert-${params.type}${params.animation? ' modal-alert-animated' : ''}\">\n        <div class=\"malert-inner\">\n          ${params.showMarks? `<div class=\"malert-mark\">${marks[params.type]}</div>` : ''}\n          <div class=\"malert-body\">\n            ${params.title? `<div class=\"malert-heading ${params.heading_class?? ''}\">${params.title}</div>` : ''}\n            <div class=\"malert-text ${params.text_class?? ''}\">${params.mes?? ''}</div>\n            <div class=\"malert-btns\">\n              <button type=\"button\" class=\"malert-ok ${params.ok_btn_class}\">\n                ${params.ok_btn_text}\n              </button>\n              ${params.type === 'confirm'?\n                `<button type=\"button\" class=\"malert-cancel ${params.cancel_btn_class}\">\n                  ${params.cancel_btn_text}\n                </button>`\n              : ''}\n              ${params.extra_btn?? ''}\n            </div>\n          </div>\n        </div>\n      </dialog>`\n    );\n\n    dialog = document.querySelector('.modal-alert');\n\n    dialog.showModal();\n\n    // btn focus\n    const ok_btn = dialog.querySelector('.malert-ok'),\n      cancel_btn = dialog.querySelector('.malert-cancel'),\n      extra_btn = (params.extra_btn && params.extra_btn_selector)? dialog.querySelector(params.extra_btn_selector) : null;\n\n    if(extra_btn && params.extra_btn_focus) {\n      extra_btn.focus();\n\n    } else if(cancel_btn && params.cancel_focus) { // confirm\n      cancel_btn.focus();\n\n    } else {\n      ok_btn.focus();\n    }\n\n    if(params.onOpen && typeof params.onOpen === 'function') {\n      params.onOpen();\n    }\n\n    let timeoutID;\n\n    const dialogDismiss = (btn) => {\n      dialog.remove();\n\n      if(params.onClose && typeof params.onClose === 'function') {\n        params.onClose();\n      }\n\n      // Se presente, l'argomento del callback è btn.dataset.confirmResult\n      // altrimenti, se il modal è di tipo confirm true se è il pulsante OK, false in caso contrario\n      // altrimenti undefined\n      if(params.callback && typeof params.callback === 'function') {\n        let arg;\n        if(btn) {\n          if(btn.dataset?.confirmResult) {\n            arg = btn.dataset.confirmResult;\n\n          } else if(params.type === 'confirm') {\n            arg = btn.classList.contains('malert-ok');\n          }\n        } else {\n          arg = undefined;\n        }\n\n        params.callback(arg);\n      }\n\n      if(timeoutID) {\n        window.clearTimeout(timeoutID);\n      }\n    };\n\n    if( params.timer && params.type !== 'confirm') {\n      timeoutID = window.setTimeout( function() {\n        dialogDismiss();\n      }, params.timer);\n    }\n\n    dialog.addEventListener('close', () => {\n      dialogDismiss();\n    }, false);\n\n    [ok_btn, cancel_btn, ...(extra_btn? [extra_btn] : [])].forEach(btn => {\n\n      btn?.addEventListener('click', () => {\n        dialogDismiss(btn);\n      }, false);\n\n    });\n\n\n  } catch(e) {\n    console.error( e ); // eslint-disable-line\n  }\n\n}\n"],"names":["defaults","globals","onOpen","onClose","cssFile","animation","showMarks","callback","timer","mes","heading_class","text_class","extra_btn","extra_btn_selector","extra_btn_focus","success","title","ok_btn_text","ok_btn_class","error","warning","info","confirm","cancel_btn_text","cancel_focus","cancel_btn_class","modalAlert","params","custom_defaults","marks","confirm_mark","info_mark","error_mark","success_mark","warning_mark","dialog","document","querySelector","remove","type","Object","keys","filter","item","indexOf","head","insertAdjacentHTML","body","showModal","ok_btn","cancel_btn","timeoutID","focus","dialogDismiss","btn","arg","dataset","confirmResult","classList","contains","undefined","window","clearTimeout","setTimeout","addEventListener","forEach","e","console"],"mappings":"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"}